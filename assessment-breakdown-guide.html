<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assessment Breakdown Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .test-section {
        margin: 20px 0;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
      }
      .demo-result {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 6px;
        margin: 10px 0;
      }
      .success {
        color: green;
      }
      .error {
        color: red;
      }
      .info {
        color: blue;
      }
      code {
        background: #f1f1f1;
        padding: 2px 6px;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <h1>Assessment Question Breakdown - Implementation Guide</h1>
    <div class="test-section">
      <h2>‚úÖ What Has Been Implemented</h2>
      <ul class="success">
        <li>
          <strong>Question Fetching:</strong> Functions to retrieve quiz
          questions from Firebase
        </li>
        <li>
          <strong>Answer Comparison:</strong> Logic to compare user answers with
          correct answers
        </li>
        <li>
          <strong>Integrated Breakdown:</strong> Detailed question breakdown
          integrated into the "View Details" page
        </li>
        <li>
          <strong>Enhanced Display:</strong> Shows correct/incorrect answers
          with visual indicators
        </li>
        <li>
          <strong>Responsive Design:</strong> Mobile-friendly layout with proper
          styling
        </li>
      </ul>
    </div>

    <div class="test-section">
      <h2>üîß Expected Firebase Data Structure</h2>
      <p>
        For the breakdown to work properly, your Firebase should have this
        structure:
      </p>

      <h3>Quiz Collection (quiz/{quizCode})</h3>
      <div class="demo-result">
        <pre><code>{
  "title": "JavaScript Basics Quiz",
  "code": "QUIZ123",
  "questions": [
    {
      "question": "What is the correct way to declare a variable in JavaScript?",
      "options": [
        "var x = 5;",
        "variable x = 5;",
        "v x = 5;",
        "declare x = 5;"
      ],
      "correctAnswer": "A",
      "explanation": "var is the traditional way to declare variables in JavaScript."
    }
  ]
}</code></pre>
      </div>

      <h3>User Assessment Results (user_assessment_results/{userEmail})</h3>
      <div class="demo-result">
        <pre><code>{
  "results": [
    {
      "quizCode": "QUIZ123",
      "score": 8,
      "percentage": 80,
      "timestamp": { "seconds": 1703097600 },
      "answers": {
        "1": "A",  // Question 1 answer
        "2": "B",  // Question 2 answer
        "3": "C"   // Question 3 answer
      }
    }
  ]
}</code></pre>
      </div>
    </div>
    <div class="test-section">
      <h2>üéØ How It Works</h2>
      <ol>
        <li>
          <strong>User clicks "View Details"</strong> button on any assessment
        </li>
        <li>
          <strong>System navigates to detailed view</strong> with comprehensive
          breakdown
        </li>
        <li>
          <strong>Fetches quiz questions</strong> using the
          <code>quizCode</code>
        </li>
        <li>
          <strong>Compares user answers</strong> with correct answers from quiz
          data
        </li>
        <li>
          <strong>Displays integrated breakdown</strong> showing:
          <ul>
            <li>Assessment summary (score, percentage, timing)</li>
            <li>Each question text with full breakdown</li>
            <li>All available options (A, B, C, D)</li>
            <li>User's selected answer (highlighted)</li>
            <li>Correct answer (highlighted in green)</li>
            <li>‚úì or ‚úó status for each question</li>
            <li>Overall accuracy and statistics</li>
          </ul>
        </li>
      </ol>
    </div>

    <div class="test-section">
      <h2>üõ† Testing Your Implementation</h2>
      <ol>
        <li>
          <strong>Ensure your quiz data exists:</strong>
          <ul>
            <li>Go to Firebase Console ‚Üí Firestore</li>
            <li>
              Check that <code>quiz</code> collection has documents with your
              quiz codes
            </li>
            <li>
              Verify each quiz has <code>questions</code> array with proper
              structure
            </li>
          </ul>
        </li>
        <li>
          <strong>Test the breakdown feature:</strong>
          <ul>
            <li>Go to your assessment reports page</li>
            <li>Click the "View Details" button on any assessment</li>
            <li>
              Verify the detailed breakdown appears with question-by-question
              analysis
            </li>
            <li>
              Check that correct/incorrect answers are clearly highlighted
            </li>
          </ul>
        </li>
        <li>
          <strong>Check browser console:</strong>
          <ul>
            <li>Open Developer Tools (F12)</li>
            <li>Look for any error messages in the Console tab</li>
            <li>Debug logs will show the data fetching process</li>
          </ul>
        </li>
      </ol>
    </div>

    <div class="test-section">
      <h2>‚ö†Ô∏è Common Issues & Solutions</h2>
      <div class="error">
        <h3>Issue: "Unable to load question breakdown"</h3>
        <p>
          <strong>Solution:</strong> Check that your quiz document exists in
          Firestore with the correct quizCode
        </p>
      </div>

      <div class="error">
        <h3>Issue: Questions show but answers are all "Not answered"</h3>
        <p>
          <strong>Solution:</strong> Verify the answer key format in
          user_assessment_results matches what the code expects (1, 2, 3... or
          0, 1, 2...)
        </p>
      </div>
      <div class="error">
        <h3>Issue: Breakdown doesn't appear in details page</h3>
        <p>
          <strong>Solution:</strong> Check browser console for errors and verify
          quiz data exists in Firestore
        </p>
      </div>
    </div>

    <div class="test-section">
      <h2>üöÄ Next Steps</h2>
      <ol>
        <li>Deploy the updated JavaScript and CSS files</li>
        <li>Test with a real assessment that has questions in Firebase</li>
        <li>
          Verify the breakdown shows correctly for both correct and incorrect
          answers
        </li>
        <li>
          Optionally add more features like:
          <ul>
            <li>Export breakdown as PDF</li>
            <li>Filter by correct/incorrect questions only</li>
            <li>Show time taken per question</li>
          </ul>
        </li>
      </ol>
    </div>

    <p>
      <strong>Note:</strong> The breakdown functionality is now integrated into
      the "View Details" page. Users will see a comprehensive assessment report
      with question-by-question analysis automatically!
    </p>
  </body>
</html>
